/*! dxui by DXkite 2016-11-22 */
!function(){"use strict";function a(a){for(var b={},c=0;c<arguments.length;c++)for(var d in arguments[c])b[d]=arguments[c][d];return b}function b(a){return"'"+a.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function c(a){return"[object Array]"===Object.prototype.toString.call(a)}var d={},e={cache:!0,tags:["{","}"],compress:!0,use_strict:!0},f="if,else,each,include,while,for",g="^\\s*((?:/)?(?:"+f.split(",").join("|")+"))(.*)",h=e.tags[0],i=e.tags[1],j=e.cache,k=e.compress,l=e.use_strict;d.config=function(a){j=void 0!==typeof a.cache?a.cache:e.cache,k=void 0!==typeof a.compress?a.compress:e.compress,a.tags&&2===a.tags.length&&(h=a.tags[0],i=a.tags[1])};var m="".trim,n=m?["$_tpl_=''","$_tpl_+=",";","$_tpl_"]:["$_tpl_=[]","$_tpl_.push(",");","$_tpl_.join('')"],o={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},p=function(a,c){try{new Function(a)}catch(a){return"throw "+a.name+"("+b(a.message)+");{"}return c},q={html:function(a){var c="";return a.match(/(?!^)\n/)?u(a.split("\n"),function(a){a&&(k&&(a=a.replace(/\s+/g," ").replace(/<!--.*?-->/g,"")),a&&(c+=n[1]+b(a)+n[2],c+="\n"))}):a&&(c+=n[1]+b(a)+n[2]),c},code:function(a){var b;if(!(b=a.match(new RegExp(g))))return(b=a.match(/^!.*$/))?n[1]+"$_unit._echo("+b[1]+")"+n[2]:n[1]+"$_unit._escape("+a+")"+n[2];var c=b[1],d=b[2];switch(c){case"include":return d=d.trim().split(" "),1===d.length&&d.push("$_unit.value"),d=d.join(","),n[1]+"$_unit._include("+d+")"+n[2];case"if":return p("if("+d+"){}","if ("+d+") {");case"else":return(b=d.match(/^\s*if\s+(.*)/))?"} else if ("+b[1]+"){":"}else{";case"/if":case"/while":case"/for":return"}";case"while":return p("while("+d+"){}","while ("+d+") {");case"for":return p("for("+d+"){}","for ("+d+") {");case"each":var b=d.match(/(\w+)\s+(?:(?:as(?:\s+(\w+)))?(?:(?:\s+=>)?\s+(\w+))?)?/);if(b){var e,f=b[1];return e=b[2]?b[3]?b[3]+","+b[2]:b[2]:"value,index","$_unit._each("+f+",function("+e+"){"}return'throw SyntaxError("Null Each Value");$_unit._each(null,function(){';case"/each":return"});"}}},r=function(a){return o[a]},s=function(a){return new String(a)},t=function(a){return s(a).replace(/&(?![\w#]+;)|[<>"']/g,r)},u=function(a,b){if(c(a))v(a,b);else for(var d in a)b.call(a[d],a[d],d)},v=function(a,b){for(var c=0;c<a.length;++c)b.call(a[c],a[c],c)},w=function(a,b){if(!document.getElementById(a))throw Error("No Template "+a);try{var c=new D(a,b);return c instanceof String?c:"[Error Template "+a+"]"}catch(a){throw a}},x=function(a,b,c,d){var a=a||"anonymous",e="DxTPL Error:";if(console.group(e),b){var f=b.replace(/^\n/,"").split("\n"),g=c-5>0?c-5:1,h=c+5>f.length?f.length:c+5;console.error(d);for(var i=g;i<h;i++)i==c?console.log(i+"|%c"+f[c-1]+"\t\t%c->\t\t%c"+d.name+":"+d.message,"color:red;","color:green;","color:red;"):console.log(i+"|"+f[i-1])}else console.log(b),console.log("%c"+e+d.message+"\t\t@"+a+":"+c,"color:red;");console.groupEnd(e)},y=function(a,b){var c="";return a=a.replace(/^\n/,""),console.log(h),u(a.split(h),function(a,d){var e=a.split(i);1===e.length?c+=b.html(e[0]):(c+=b.code(e[0]),c+=b.html(e[1]))}),c},z=function(a,b){var c=[];c.push("var $_unit=this,"+n[0]);for(var d in b)c.push(d+"=this.value."+d);var e="";return l&&(e='"use strict";'),e+=c.join(","),e+=";",e+=a+"return new String("+n[3]+");"},A=function(a,b,c,d){var e,f=z(c,d),g={_each:u,_echo:s,_escape:t,_include:w,value:d};try{var h=new Function(f);e=h.call(g)}catch(c){var i=new String(c.stack).match(/<anonymous>:(\d+):\d+/);if(i){var j=i[1]-1;x(a,b,j,c)}else{var a=a||"anonymous",i=new String(c.stack).match(/Function code:(\d+):\d+/);i?console.error("DxTPL:Compile Error@"+a+" Line "+i[1]):console.error("DxTPL:Compile Error@"+a)}}return e},B=function(a){var b=document.getElementById("template_caches");b||(b=document.createElement("div"),b.id="template_caches",b.style.display="none",document.body.appendChild(b));var c="template_cache_"+a,d=document.getElementById("template_cache_"+a);return d||(d=document.createElement("div"),d.id=c,d.innerText=y(document.getElementById(a).innerHTML,q),b.appendChild(d)),d.innerText},C=function(b,c){var d=document.querySelectorAll(b);v(d,function(d,e){var f,g=d.innerHTML;if(d.dataset.tplInit)try{var h=new Function("return "+d.dataset.tplInit+";");f=h()}catch(a){x(b+"["+e+"]",null,0,new Error("Unsupport json"))}f=a(f,c);var i=y(g,q);d.innerHTML=A(b,g,i,f)})},D=function(a,b){if("string"!=typeof a)throw Error("Unsupport Template ID");var c,e=document.getElementById(a),f=e.innerHTML;return c=j?B(a):y(f,q),b?A(a,f,c,b):{config:d.config,display:function(b){return A(a,f,c,b)}}};d.compile=function(a){return{display:function(b){return A(null,a,y(a,q),b)}}},d.template=D,d.selftpl=C,window.DxTPL=d}(),!function(){function a(a){return"[object Function]"===Object.prototype.toString.call(a)}function b(a){return"[object Array]"===Object.prototype.toString.call(a)}function c(a){return"string"==typeof a}function d(){var a=document.getElementsByTagName("script"),b=a[a.length-1].getAttribute("src");return b.substring(0,b.lastIndexOf("/"))}function e(a){for(var b={},c=0;c<arguments.length;c++)for(var d in arguments[c])b[d]=arguments[c][d];return b}function f(a){return a=a.trim(),a="undefined"==typeof document.documentElement.style[a]?l+a:a}function g(a,b){var c=b||a,d=a;d.style.position="fixed";var e=function(a){a.preventDefault();var b="mousemove",e="mouseup";a.touches&&(a=a.touches[0],b="touchmove",e="touchend");var f=c.getBoundingClientRect(),g=a.clientX-f.left,h=a.clientY-f.top,i=document;d.setCapture?d.setCapture():window.captureEvents&&window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);var j=function(a){a.touches&&(a=a.touches[0]);var b=a.pageX||a.clientX+document.body.scrollLeft-document.body.clientLeft,c=a.pageY||a.clientY+document.body.scrollTop-document.body.clientTop,e=b-g,f=c-h;d.style.left=e+"px",d.style.top=f+"px"},k=function(a){d.releaseCapture?d.releaseCapture():window.releaseEvents&&window.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP),i.removeEventListener(b,j),i.removeEventListener(e,k)};i.addEventListener(b,j),i.addEventListener(e,k)};return c.addEventListener("mousedown",e),c.addEventListener("touchstart",e),d}var h,i,j=function(){var a=document.getElementsByTagName("script");return a[a.length-1].getAttribute("src")}();(function(){return j.substring(0,j.lastIndexOf("/"))})();window.addEventListener("error",function(a){console.log(a);var b=a.message+"\n";a.error.stack&&(b+="---- ErrorStack-----\n"+a.error.stack),alert(b)});var k=function(b,c,d,e,f){var g=document.createEvent(m[0]),h=void 0===typeof e||e,i=void 0===typeof f||f;return g.initCustomEvent(c,h,i,d),b.dispatchEvent(g),b["on"+c]&&a(b["on"+c])&&b["on"+c].call(b,g),g},l=function(){var a=window.getComputedStyle(document.documentElement,""),b=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms|)-/)||""===a.OLink&&["","o"])[1];return"-"+b+"-"}();h=function(a,b){return new h.static.create(a,b)},h.static=h.prototype,h.static.create=function(a,b){"string"==typeof a?this.elements=(b||document).querySelectorAll(a):this.elements=[a],this.context=b,this.length=this.elements.length;for(var c=0;c<this.length;c++)this[c]=this.elements[c];return this.each=function(a){for(var b=0;b<this.length;b++)a.call(this[b],this[b],b);return this},this},h.static.extend=function(a){for(var b in a)this[b]=a[b]},h.static.create.prototype=h.static,h.static.extend({createElement:function(a,b,c){var d=document.createElement(a);return h(d).setAttr(b).setCss(c),d},setAttr:function(a){return this.each(function(){if(a)for(var b in a)this.setAttribute(b,a[b])}),this},setCss:function(a){return this.each(function(){if(a)for(var b in a)this.style[f(b)]=a[b]}),this},addClass:function(a){return this.each(function(){this.class+=" "+a}),this},removeClass:function(a){return this.each(function(){var b=new RegExp("/\\s+?"+a+"/");this.class.replace(b,"")}),this},on:function(a,b,c){return this.each(function(){this.addEventListener(a,b,c)}),this}});var m=["CustomEvent","css-insert","Content-Type","toast-parent","application/json","readystatechange","toast_show","toast","win","win-head","win-body","win-head-btn","icon-close","win-btns"],n=4e3,o=3e3;i={ver:"0.1",loadCss:function(a){if("string"==typeof a){var b=a;/https?:\/\/|\//.test(a)||(b=d()+"/"+a);var c=document.createElement("link");c.setAttribute("rel","stylesheet"),c.setAttribute("href",b),c.id=b.replace(/[^a-zA-Z]/g,"-").replace(/-+/,"-"),console.log("LoadingCss:"+b),document.head.appendChild(c)}},insertCSS:function(a){function b(a){var b="{";for(var c in a)b+=d.cssName(c),b+=":"+a[c]+";";return b+"}"}var c=document.getElementById(m[1]);c||(c=document.createElement("style"),c.id=m[1],document.head.appendChild(c));var d=this,e="/* create css "+f+" */";for(var f in a)e+=f+b(a[f]);c.innerText+=e},extend:function(a){for(var b in a)this[b]=a[b]}};var p=new Array,q=function(a,b){for(var c=0;c<a.length;++c)b.call(a[c],a[c],c)},r=function(a){var c=e(a),d=c.type||"button",f=c.text;delete c.text;var g=c.on||[];delete c.on;var j=c.css||{};delete c.css;var k=h.static.createElement("button",c,j);return k.innerText=f||"button",i[d]&&(k=new i[d](k)),q(g,function(a){b(a)?h(k).on(a[0],a[1],a[2]):h(k).on(a.name,a.callback,a.useCaptrue)}),k};i.extend({moveable:g,createButton:r,Toast:function(a,b){var c=document.getElementById(m[3]);return c||(c=document.createElement("div"),c.id=m[3],document.body.appendChild(c)),p.push({message:a,timeout:b}),{show:function a(){if(!document.getElementById(m[6])){var b=p.shift(),d=h.static.createElement("div",{id:m[6],class:m[7]});d.innerHTML=b.message,c.appendChild(d);var e=window.innerWidth/2-d.scrollWidth/2,f=window.innerHeight-2*d.scrollHeight;d.style.marginLeft=e+"px",d.style.top=f+"px";var g=b.timeout||2e3,i=function(){h(d).setCss({transition:"opacity 0.3s ease-out",opacity:0}),setTimeout(function(){c.removeChild(d),p.length&&a()},300)};h(d).setCss({position:"fixed",opacity:1,"z-index":n,transition:"opacity 0.1s ease-in"}),setTimeout(i,g)}}}},Window:function(a){var b,d,e=!1;b=h.static.createElement("div",{class:m[8]}),b.config=a;var f=function(a){return d=h.static.createElement("span",{class:m[11]+" "+m[12]}),d.addEventListener("mousedown",b.close),d.addEventListener("touchstart",b.close),a.appendChild(d),d},i=function(a){var d=h.static.createElement("div",{class:m[10]}),e=h.static.createElement("div",{class:m[9]}),i=h.static.createElement("div",{class:m[13]});if(b.innerHTML="",b.config=a||b.config,d.innerHTML=b.config.content||"No Content",e.innerHTML=b.config.title||"No Title",i.innerHTML="",b.config.moveable="undefined"==typeof b.config.moveable||b.config.moveable,b.btn=b.config.btn,b.config.moveable&&(b=g(b,e)),b.appendChild(e),b.appendChild(d),b.appendChild(i),document.body.appendChild(b),b.style.zIndex=o,b.index=o,o++,b.btn)for(var j in b.btn){var k=b.btn[j];if(c(k))switch(k){case"close":f(e)}else i.appendChild(r(b.btn[j]))}};b.addEventListener("mousedown",l),b.addEventListener("touchstart",l),b.isOpen=function(){return e},b.open=function(){return e||(e=!0,i(),k(b,"open")),b},b.close=function(a){return a?(setTimeout(j,a),b):(j(),b)};var j=function(){if(e){var a=k(b,"close");if(a.defaultPrevented)return;document.body.removeChild(b),o--,e=!1}},l=function(){b.style.zIndex<o&&(b.style.zIndex=o,b.index=o,o++)};return b},AjaxButton:function(a){var b=a;return b.addEventListener("click",function(){console.log("click me"),b.method=b.getAttribute("method")||"POST",b.action=b.getAttribute("action");var a=new XMLHttpRequest;a.addEventListener(m[5],function(){var c=document.createEvent(m[0]);c.initCustomEvent(m[5],!0,!0,{xhr:a}),b.responseText=a.responseText,b.dispatchEvent(c),4==a.readyState&&(200==a.status?k(b,"message",{xhr:a,json:JSON.parse(a.responseText),text:a.responseText,xml:a.responseXML}):k(b,"error",{xhr:a}))}),a.open(b.method,b.action,!0);var c=document.getElementById(b.dataset.form);c?a.send(new FormData(c)):(a.setRequestHeader(m[2],m[4]),a.send(b.dataset.data))}),b}}),window.DxUI=i,window.DxDOM=h}();